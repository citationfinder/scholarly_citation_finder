<div class="page-header">
	<h1>MAG Citations</h1>
</div>

<h3>Create a task</h3>
<form class="form-horizontal" ng-submit="submitTask(authorName, authorId)">
  <div class="form-group">
    <label for="authorName" class="col-sm-2 control-label">Author name</label>
    <div class="col-sm-10">
      <input ng-model="authorName"
			 type="text" class="form-control" id="authorName" placeholder="Enter a name of an author">
    </div>
  </div>
  <div class="form-group">
    <label for="authorId" class="col-sm-2 control-label">Author ID</label>
    <div class="col-sm-10">
      <input ng-model="authorId"
			type="number" class="form-control" id="authorId" placeholder="Or enter an author ID">
    </div>
  </div>
  <div class="form-group">
    <div class="col-sm-offset-2 col-sm-10">
      <button type="submit" class="btn btn-primary">Create task</button>
    </div>
  </div>
</form>

<h3>Current tasks</h3>
<p><small>{{tasks.length}} jobs</a> | <a ng-click="getTasks()" href="">Refresh</a></small></p>
<table class="table table-striped">
	<tr>
		<th>#</th>
		<th>Start time</th>
		<th>Status</th>
	</tr>
	<tr ng-repeat="item in tasks">
		<td>{{item.id}}</td>
		<td>{{item.starttime}}</td>
		<td><a ng-click="getTask($index, item.id)" href="">{{item.status}}</a></td>
	</tr>
</table>

<h3>Display task # {{task.id}}</h3>

<span ng-show="task.status == 'FAILURE'">
	Traceback:
	<textarea class="form-control" rows="10">{{task.traceback}}</textarea>
</span>
<span ng-show="task.status == 'SUCCESS'">
	<button type="button" class="btn btn-default btn-sm" ng-click="isCollapsed = !isCollapsed">Export as SCF-JSON</button>
	<br>
	<div uib-collapse="isCollapsed">
		<textarea class="form-control" rows="10">{{task.result}}</textarea>	
	</div>
	<br>
	Result:
	<ol>
		<li ng-repeat="item in task.result">
			<i>{{item.title}}</i>, {{item.year}}
			<ol>
				<li ng-repeat="citation in item.citations">
					<i>{{citation.title}}</i>, {{citation.year}}
				</li>
			</ol>
		</li>
	</ol>
</span>